---
title: Solving Proofs, Arguments, and Zero-Knowledge
date: '2025-03-23'
tags: ['zero knowledge', 'cryptography']
draft: false
summary: In this post, I discuss the solutions to all exercises in Justin Thaler's excellent book, Proofs, Arguments and Zero-Knowldge.
---

*This post is a work in progress.*

## Chapter 3: Definitions and Technical Preliminaries

### Exercise 3.1

Let $A, B, C$ be $n \times n$ matrices over a field $\mathbb{F}$.
In Section 2.2, we presented a randomized algorithm for checking that $C = A \cdot B$.
The algorithm picked a random field element $r$, let $x = \left( r, r^2,...,r^n \right)$, and output EQUAL if $Cx = A \cdot (Bx)$, and output NOT-EQUAL otherwise.
Suppose instead that each entry of the vector $x$ is chosen independently and uniformly at random from $\mathbb{F}$. 
Show that:

- If $C_{ij} = (AB)_{ij}$ for all $i = 1,...,n, j = 1,...,n$, then the algorithm outputs EQUAL for every possible choice of $x$.

- If there is even one $(i,j) \in [n] \times [n]$ such that $C_{ij} \neq (AB)_{ij}$, then the algorithm outputs NOT-EQUAL with probability at least $1 - 1/|\mathbb{F}|$.

#### Solution

First, let $x = (x_1,...,x_n)\in \mathbb{F}^n$, where each $x_i$ is chosen independently and uniformly at random from $\mathbb{F}$.
Furthermore, let $D = A \cdot B$, so that our goal is to determine whether the $\textit{claimed}$ product matrix $C$ actually equals the $\textit{true}$ product matrix $D$.

The first property (completeness) is easy to see:
if $C=D$, then clearly $Cx=Dx$ for any $x\in \mathbb{F}^n$, so the algorithm will output EQUAL for every choice of $x$.

To see that the second property (soundness) holds, let us define the matrix $E := C-D$.
Furthermore, suppose $C\neq D$, i.e., $E\neq 0$.
Since $E$ is non-zero, we have that $\text{rank}(E) \geq 1$.
By the [rank-nullity theorem](https://en.wikipedia.org/wiki/Rank%E2%80%93nullity_theorem), we then have that $\text{dim(ker}(E)) \leq n-1$.
Since our vector coordinates $x_i$ are sampled independently and uniformly at random from $\mathbb{F}$, the soundness error is given by 
$$
\text{Pr}_{x\in \mathbb{F}^n}[Ex=0] = \frac{|\text{ker}(E)|}{|\mathbb{F}^n|}\leq \frac{|\mathbb{F}^{n-1}|}{|\mathbb{F}^{n}|} = \frac{1}{|\mathbb{F}|}
$$

In other words, if there is even one $(i,j) \in [n] \times [n]$ such that $C_{ij} \neq (AB)_{ij}$, then the algorithm outputs NOT-EQUAL with probability at least $1 - 1/|\mathbb{F}|$.

### Exercise 3.2

In Section 2.1, we described a communication protocol of logarithmic cost for determining whether Alice's and Bob's input vectors are equal.
Specifically, Alice and Bob interpreted their inputs as degree-$n$ univariate polynomials $p_a$ and $p_b$, chose a random $r \in \mathbb{F}$ with $|\mathbb{F}|>>n$, and compared $p_a(r)$ to $p_b(r)$.
Give a different communication protocol in which Alice and Bob interpret their inputs as multilinear rather than univariate polynomials over $\mathbb{F}$.
How large should $\mathbb{F}$ be to ensure that the probability Bob outputs the wrong answer is at most $1/n$?
What is the communication cost in bits of this protocol?

### Exercise 3.3

Let $p = 11$. Consider the function $f:\{0,1\}^2\rightarrow\mathbb{F}_p$ given by $f(0,0)=3, f(0,1)=4, f(1,0)=1$, and $f(1,1)=2$.
Write out an explicit expression for the multilinear extension $\tilde{f}$ of $f$. 
What is $\tilde{f}(2,4)$?

Now consider the function $f: \{0,1\}^3\rightarrow \mathbb{F}_p$ given by $f(0,0,0)=1, f(0,1,0)=2, f(1,0,0)=3, f(1,1,0)=4, f(0,0,1)=5, f(0,1,1)=6, f(1,0,1)=7, f(1,1,1)=8$.
What is $\tilde{f}(2,4,6)$?
How many field multiplications did you perform during the calculation?
Can you work through the calculation of $\tilde{f}(2,4,6)$ that uses "just" 20 multipliactions operations?
Hint: see Lemma 3.8.

#### Solution

Let $p = 11$. Consider the function $f:\{0,1\}^2\rightarrow\mathbb{F}_p$ given by $f(0,0)=3, f(0,1)=4, f(1,0)=1$, and $f(1,1)=2$.
Using Lemma 3.6, we can compute $\tilde{f}$ via:
$$
\begin{aligned}
\tilde{f}(x_1, x_2) &= \sum_{w\in \{0,1\}^2}f(w)\cdot \prod_{i=1}^2 (x_i w_i + (1-x_i)(1-w_i))\\
&= 3(1-x_1)(1-x_2) + 4(1-x_1)x_2 + x_1(1-x_2) + 2x_1x_2
\end{aligned}
$$

Consequently, we have $\tilde{f}(2,4) = 3$.

Now consider the function $f: \{0,1\}^3\rightarrow \mathbb{F}_p$ given by $f(0,0,0)=1, f(0,1,0)=2, f(1,0,0)=3, f(1,1,0)=4, f(0,0,1)=5, f(0,1,1)=6, f(1,0,1)=7, f(1,1,1)=8$.
Using Lemma 3.6, we can compute $\tilde{f}$ via

$$
\tilde{f}(x_1, x_2, x_3) = \sum_{w\in \{0,1\}^3}\tilde{f}_w(x_1,x_2,x_3)
$$

where:

$$
\begin{aligned}
\tilde{f}_{(0,0,0)}(x_1, x_2, x_3) &= 1\cdot (1-x_1)\cdot (1-x_2)\cdot (1-x_3) \\
\tilde{f}_{(0,1,0)}(x_1, x_2, x_3) &= 2\cdot(1-x_1)\cdot x_2\cdot(1-x_3) \\
\tilde{f}_{(1,0,0)}(x_1, x_2, x_3) &= 3\cdot x_1\cdot (1-x_2)\cdot (1-x_3) \\
\tilde{f}_{(1,1,0)}(x_1, x_2, x_3) &= 4\cdot x_1\cdot x_2\cdot (1-x_3) \\
\tilde{f}_{(0,0,1)}(x_1, x_2, x_3) &= 5\cdot (1-x_1)\cdot (1-x_2)\cdot x_3 \\
\tilde{f}_{(0,1,1)}(x_1, x_2, x_3) &= 6\cdot (1-x_1)\cdot x_2\cdot x_3 \\
\tilde{f}_{(1,0,1)}(x_1, x_2, x_3) &= 7\cdot x_1\cdot (1-x_2)\cdot x_3 \\
\tilde{f}_{(1,1,1)}(x_1, x_2, x_3) &= 8\cdot x_1\cdot x_2\cdot x_3 \\
\end{aligned}
$$

Consequently, we can compute $\tilde{f}(2,4,6) = 33$ using a total of 24 multiplications.
Using the memoization procedure from Lemma 3.8, we can reduce the number of required multiplications to 20.
To see that, notice that each of the following four multiplications appears twice in the above expressions for the $\tilde{f}_w$.

- $(1-x_1)\cdot (1-x_2)$
- $(1-x_1)\cdot x_2$
- $x_1\cdot (1-x_2)$
- $x_1\cdot x_2$

Therefore, it suffices to compute each of them only once instead of evaluating each instance at $(2,4,6)$ independently.
As a result, we only need a total of $20 = 24 - 4$ multiplications to compute $\tilde{f}(2,4,6)$.


### Exercise 3.4

Fix some prime $p$ of your choosing.
Write a Python program that takes as input an array of lenght $2^l$ specifying all evaluations of a function $f: \{0,1\}^l \rightarrow \mathbb{F}_p$ and a vector $\mathbf{r}\in \mathbb{F}_p^l$, and outputs $\tilde{f}(\mathbf{r})$.